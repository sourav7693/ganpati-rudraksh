(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,t,s)=>{t.exports=e.r(76562)},20055,e=>{"use strict";var t=e.i(43476),s=e.i(71645),r=e.i(18566),a=e.i(5766),l=e.i(10936);function i({review:e,onClose:i,onUpdate:o}){let[n,d]=(0,s.useState)(e.rating),[c,m]=(0,s.useState)(0),[u,p]=(0,s.useState)(e.title),[x,h]=(0,s.useState)(e.description),[f,g]=(0,s.useState)([]),[v,b]=(0,s.useState)(e.supporting_files.map(e=>({...e,name:e.url.split("/").pop()||"",type:R(e.url)}))),[j,y]=(0,s.useState)(!1),w=(0,s.useRef)(null),N=(0,r.useRouter)();function R(e){let t=e.split(".").pop()?.toLowerCase();return["jpg","jpeg","png","gif","webp","svg"].includes(t||"")?"image/*":["mp4","webm","ogg","mov","avi"].includes(t||"")?"video/*":"application/octet-stream"}let S=e=>{let t=("type"in e,e.type);return t?.startsWith("image/")?"ðŸ–¼ï¸":t?.startsWith("video/")?"ðŸŽ¬":"ðŸ“„"},U=e=>"name"in e?e.name:e.name||"file",C=async t=>{if(t.preventDefault(),!u.trim()||!x.trim()||0===n)return void a.default.error("Please fill in all required fields and provide a rating");y(!0);try{let t=new FormData;if(t.append("title",u),t.append("description",x),t.append("rating",n.toString()),f.forEach(e=>{t.append("images",e)}),v.length>0){let e=v.map(e=>({url:e.url,public_id:e.public_id}));t.append("images",JSON.stringify(e))}let s=await fetch(`https://api.ganpatirudraakshaam.com/api/review/${e._id}`,{method:"PUT",body:t});if(!s.ok)throw Error(`Failed to update review: ${s.statusText}`);let r=await s.json();a.default.success("Review updated successfully!"),o&&o(r),i&&i(),f.forEach(e=>{e.preview&&URL.revokeObjectURL(e.preview)}),N.push("/my-reviews")}catch(e){console.error("Error updating review:",e),a.default.error(e.message||"Failed to update review. Please try again.")}finally{y(!1)}};return(0,s.useEffect)(()=>()=>{f.forEach(e=>{e.preview&&URL.revokeObjectURL(e.preview)})},[]),(0,s.useEffect)(()=>{d(e.rating),p(e.title),h(e.description),b(e.supporting_files.map(e=>({...e,name:e.url.split("/").pop()||"",type:R(e.url)}))),g([])},[e]),(0,t.jsxs)("form",{className:"max-w-225 mx-auto bg-white px-4 rounded-md shadow-sm py-8 md:my-6",onSubmit:C,children:[(0,t.jsxs)("div",{className:"mt-6",children:[(0,t.jsx)("p",{className:"font-medium mb-2",children:"Rate this product"}),(0,t.jsx)("div",{className:"flex gap-1",children:[1,2,3,4,5].map(e=>(0,t.jsx)("button",{type:"button",onClick:()=>d(e),onMouseEnter:()=>m(e),onMouseLeave:()=>m(0),children:(0,t.jsx)(l.IoMdStar,{size:28,className:`${e<=(c||n)?"fill-yellow-400 text-yellow-400":"text-gray-300"}`})},e))})]}),(0,t.jsxs)("div",{className:"mt-6",children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Review title *"}),(0,t.jsx)("input",{type:"text",placeholder:"Eg: Very good product",className:"w-full border border-gray-300 rounded px-3 py-2 text-sm focus:outline-none focus:ring-1 focus:ring-blue-500",onChange:e=>p(e.target.value),value:u,required:!0})]}),(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Your review *"}),(0,t.jsx)("textarea",{rows:4,value:x,onChange:e=>h(e.target.value),placeholder:"Share details of your experience",className:"w-full border border-gray-300 rounded px-3 py-2 text-sm focus:outline-none focus:ring-1 focus:ring-blue-500",required:!0})]}),v.length>0&&(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("p",{className:"text-sm font-medium mb-1",children:"Current Files"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mb-2",children:"Remove files you want to delete from the review"}),(0,t.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:v.map(e=>(0,t.jsxs)("div",{className:"relative group border border-gray-200 rounded-lg overflow-hidden bg-gray-50 hover:bg-gray-100 transition-all",children:[(0,t.jsx)("button",{type:"button",onClick:()=>{var t;return t=e.public_id,void b(e=>e.filter(e=>e.public_id!==t))},className:"absolute top-1 right-1 z-10 w-6 h-6 text-red-500 rounded-full flex items-center justify-center text-xs hover:text-red-600 transition-colors","aria-label":`Remove ${U(e)}`,children:(0,t.jsx)(l.IoMdClose,{})}),(0,t.jsx)("div",{className:"aspect-square flex items-center justify-center",children:e.type?.startsWith("image/")?(0,t.jsx)("img",{src:e.url,alt:U(e),className:"w-full h-full object-cover"}):e.type?.startsWith("video/")?(0,t.jsx)("div",{className:"relative w-full h-full",children:(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-3xl",children:"ðŸŽ¬"})})}):(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center p-4",children:[(0,t.jsx)("span",{className:"text-2xl mb-2",children:S(e)}),(0,t.jsx)("span",{className:"text-xs text-center break-words px-2",children:U(e)})]})})]},`existing-${e.public_id}`))})]}),(0,t.jsxs)("div",{className:"mt-6",children:[(0,t.jsx)("p",{className:"text-sm font-medium mb-1",children:"Add More Files (optional)"}),(0,t.jsxs)("label",{className:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 rounded cursor-pointer text-sm hover:bg-gray-50",children:[(0,t.jsx)("input",{type:"file",ref:w,multiple:!0,hidden:!0,accept:"image/*,video/*",onChange:e=>{let t=e.target.files;if(!t)return;let s=Array.from(t).map(e=>((e.type.startsWith("image/")||e.type.startsWith("video/"))&&(e.preview=URL.createObjectURL(e)),e));g(e=>[...e,...s]),w.current&&(w.current.value="")}}),"ðŸ“· Upload Photos / Videos"]}),f.length>0&&(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsxs)("p",{className:"text-sm font-medium mb-1",children:["New Files to Upload (",f.length,")"]}),(0,t.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:f.map((e,s)=>(0,t.jsx)("div",{className:"relative group border border-gray-200 rounded-lg overflow-hidden bg-gray-50 hover:bg-gray-100 transition-all",children:(0,t.jsx)("div",{className:"aspect-square flex items-center justify-center",children:e.type.startsWith("image/")&&e.preview?(0,t.jsx)("img",{src:e.preview,alt:e.name,className:"w-full h-full object-cover"}):e.type.startsWith("video/")&&e.preview?(0,t.jsxs)("div",{className:"relative w-full h-full",children:[(0,t.jsx)("video",{src:e.preview,className:"w-full h-full object-cover"}),(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-3xl",children:"ðŸŽ¬"})})]}):(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center p-4",children:[(0,t.jsx)("span",{className:"text-2xl mb-2",children:S(e)}),(0,t.jsx)("span",{className:"text-xs text-center break-words px-2",children:e.name})]})})},`new-${e.name}-${s}`))})]})]}),(0,t.jsxs)("div",{className:"mt-6 flex flex-col sm:flex-row gap-3 justify-end",children:[i&&(0,t.jsx)("button",{type:"button",onClick:i,className:"px-4 py-2 border border-gray-300 rounded text-sm font-medium hover:bg-gray-50 transition-colors",disabled:j,children:"Cancel"}),(0,t.jsx)("button",{type:"submit",disabled:j,className:`
             mt-3 sm:mt-auto flex items-center justify-center gap-2
              text-white font-semibold
              text-xs sm:text-sm md:text-[15px]
              px-3 py-1.5 sm:px-4 sm:py-2 md:px-5
              rounded-full
              bg-linear-to-r
              shadow-md shadow-green-500/30
              transition-all duration-300
              hover:from-emerald-600 hover:to-green-500
              hover:shadow-lg hover:scale-[1.03]
              active:scale-95
              w-full sm:w-fit
            ${j?"from-emerald-600 hover:to-green-500 cursor-not-allowed":"from-green-500 to-emerald-600"}
          `,children:j?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Updating..."]}):"Update Review"})]})]})}e.s(["default",()=>i])}]);