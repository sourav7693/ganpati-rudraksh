module.exports=[57374,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(71987),e=a.i(38246),f=a.i(71682),g=a.i(31173);function h({open:a,onClose:d,order:e}){var h;let i;if(!a||!e)return null;let j=(h=()=>{d()},i=(0,c.useRef)(null),(0,c.useEffect)(()=>{let a=a=>{i.current&&a.target instanceof Node&&!i.current.contains(a.target)&&h()};return document.addEventListener("mousedown",a),()=>{document.removeEventListener("mousedown",a)}},[h]),i),k=e.shipping?.trackingHistory||[],l=e.status,m=e.createdAt;e.shipping?.expectedDeliveryDate;let n=(()=>{let a=[],b=[{key:"Processing",title:"Order Processing",desc:"We are processing your order"},{key:"Confirmed",title:"Order Confirmed",desc:"Your order has been confirmed"},{key:"Shipped",title:"Shipped",desc:"Your item has been shipped"},{key:"InTransit",title:"In Transit",desc:"Your item is on the way"},{key:"OutForDelivery",title:"Out for Delivery",desc:"Your item is out for delivery"},{key:"Delivered",title:"Delivered",desc:"Item delivered successfully"}],c=a=>a?new Date(a).toLocaleString("en-IN",{weekday:"short",day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):null,d=b.findIndex(a=>a.key===l),f="Cancelled"===l,g="RTO"===l;f||g||-1===d&&"Processing"===l&&(d=0);for(let e=0;e<b.length;e++){let h=b[e],i=k.find(a=>a.status===h.key||a.status===h.title||a.action===h.key||a.action===h.title),j=i?c(i.timestamp||i.date):null;!j&&("Processing"===h.key&&(j=c(m)),"Confirmed"===h.key&&e<=d&&(j=c(m)));let l=d===e,n=d>e||!!i;n||l||d>=e?a.push({title:h.title,date:j||(l?"In Progress":"Completed"),desc:i?.description||h.desc,active:l,completed:n,status:h.key}):f||g||a.push({title:h.title,date:"Pending",desc:"Pending",active:!1,completed:!1,status:h.key})}return f?a.push({title:"Cancelled",date:c(e.updatedAt),desc:"Order has been cancelled",active:!0,completed:!0,status:"Cancelled",isError:!0}):g&&a.push({title:"RTO (Return to Origin)",date:c(e.updatedAt),desc:"Order is being returned to origin",active:!0,completed:!0,status:"RTO",isError:!0}),a})();return(0,b.jsx)("div",{className:"fixed inset-0 z-9999 bg-black/50 flex items-center justify-center px-4",children:(0,b.jsxs)("div",{className:"bg-white w-full max-w-md rounded-md shadow-lg relative",ref:j,children:[(0,b.jsxs)("div",{className:"flex items-center justify-between px-5 py-4 border-b border-gray-200",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold text-gray-800",children:"Order Tracking"}),(0,b.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["Order ID: ",e.orderId]})]}),(0,b.jsx)("button",{onClick:d,className:"p-1 hover:bg-gray-100 rounded-full",children:(0,b.jsx)(g.IoMdCloseCircle,{className:"text-gray-500",size:20})})]}),(0,b.jsx)("div",{className:"px-6 py-5 max-h-[60vh] overflow-y-auto no-scrollbar",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("div",{className:"absolute left-[10px] top-2 bottom-2 w-[2px] bg-gray-200"}),(0,b.jsx)("div",{className:"space-y-8",children:n.map((a,c)=>(0,b.jsxs)("div",{className:"flex gap-4 items-start relative",children:[(0,b.jsxs)("div",{className:"z-10 relative",children:[(0,b.jsxs)("div",{className:`
                      w-5 h-5 rounded-full border-2 flex items-center justify-center
                      ${a.isError?"bg-red-600 border-red-600":a.completed?"bg-define-red border-define-red":a.active?"border-define-red bg-white":"border-gray-300 bg-white"}
                    `,children:[a.completed&&!a.isError&&(0,b.jsx)(f.FaCheckCircle,{size:12,className:"text-white"}),a.isError&&(0,b.jsx)(g.IoMdCloseCircle,{size:12,className:"text-white"})]}),c<n.length-1&&(0,b.jsx)("div",{className:`
                        absolute left-1/2 top-5 w-0.5 h-8 -translate-x-1/2
                        ${n[c+1]?.isError?"bg-red-600":n[c+1]?.completed?"bg-define-red":"bg-gray-200"}
                      `})]}),(0,b.jsxs)("div",{className:"flex-1 pb-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("p",{className:`text-sm font-medium ${a.isError?"text-red-700":a.completed?"text-gray-800":a.active?"text-gray-700":"text-gray-400"}`,children:a.title}),a.status===l&&(0,b.jsx)("span",{className:`px-2 py-1 text-xs rounded-full ${a.isError?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:"Current"})]}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:a.date}),a.desc&&(0,b.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:a.desc})]})]},c))})]})}),(0,b.jsx)("div",{className:"px-5 py-4 border-t border-gray-200",children:(0,b.jsx)("button",{onClick:d,className:"w-full px-4 py-2 bg-define-brown text-white rounded-md",children:"Close Tracking"})})]})})}var i=a.i(46086),j=a.i(83490),k=a.i(50944),l=a.i(6704),m=a.i(39154);let n={Processing:"bg-yellow-500",Confirmed:"bg-amber-600",Shipped:"bg-blue-500",InTransit:"bg-indigo-500",OutForDelivery:"bg-purple-500",Delivered:"bg-define-brown",Cancelled:"bg-red-500",RTO:"bg-gray-700"};function o(){let{customer:a,loading:g}=(0,i.useCustomer)(),[o,p]=(0,c.useState)([]),[q,r]=(0,c.useState)(1),[s,t]=(0,c.useState)(1),[u,v]=(0,c.useState)(!1),[w,x]=(0,c.useState)(!1),[y,z]=(0,c.useState)(null),[A,B]=(0,c.useState)({isOpen:!1,orderId:"",orderNumber:"",reason:"",isLoading:!1}),C=(0,k.useRouter)();(0,c.useEffect)(()=>{a?._id&&((async()=>{let b=await (0,j.default)(`https://api.ganpatirudraakshaam.com/api/order/customers/${a._id}?page=${q}&limit=10`);b.data.success&&(p(b.data.data),t(b.data.pagination.totalPages))})(),window.scrollTo({top:0,behavior:"smooth"}))},[a,q]);let D=async()=>{if(!A.orderId||!A.reason.trim())return void l.default.error("Please provide a cancellation reason");B(a=>({...a,isLoading:!0}));try{let a=await j.default.put(`https://api.ganpatirudraakshaam.com/api/order/${A.orderId}`,{status:"Cancelled",cancelReason:A.reason});if(a.data.success)p(a=>a.map(a=>a._id===A.orderId?{...a,status:"Cancelled"}:a)),l.default.success("Order cancelled successfully"),E();else throw Error(a.data.message||"Failed to cancel order")}catch(b){let a=b.response?.data?.message||"Failed to cancel order";l.default.error(a)}finally{B(a=>({...a,isLoading:!1}))}},E=()=>{B({isOpen:!1,orderId:"",orderNumber:"",reason:"",isLoading:!1})},F=a=>{let b=a.product?.variables;return b&&0!==b.length?b.map(a=>`${a.name}: ${a.values.join(", ")}`).join(" | "):null};return g&&1===q?(0,b.jsx)("div",{className:"bg-white p-8 rounded-lg text-center text-gray-500 shadow-sm w-full",children:"Loading..."}):o?.length!==0||u?(0,b.jsxs)("div",{className:"px-4 flex flex-col gap-4 h-[calc(100vh-100px)] overflow-y-auto no-scrollbar",children:[u&&(0,b.jsx)("div",{className:"fixed inset-0 bg-white/50 z-50 flex items-center justify-center pointer-events-none",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-define-brown"})}),A.isOpen&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,b.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:["Cancel Order #",A.orderNumber]}),(0,b.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Are you sure you want to cancel this order? This action cannot be undone."}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason for cancellation *"}),(0,b.jsx)("textarea",{value:A.reason,onChange:a=>B(b=>({...b,reason:a.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",rows:3,placeholder:"Please provide a reason for cancellation...",required:!0})]}),(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)("button",{onClick:E,disabled:A.isLoading,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 disabled:opacity-50",children:"Go Back"}),(0,b.jsx)("button",{onClick:D,disabled:A.isLoading||!A.reason.trim(),className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed",children:A.isLoading?(0,b.jsxs)("span",{className:"flex items-center justify-center",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Cancelling..."]}):"Confirm Cancellation"})]})]})})}),o?.map(c=>{let g,h=!!c.product?.slug,i=Number(c.product?.status),j=async(b,c)=>{if(0===c)return void l.default.error("This product is out of stock");try{if(!a)return void l.default.error("Please login to proceed");sessionStorage.setItem("BUY_NOW_ITEM",JSON.stringify({productId:b,variantId:void 0,quantity:1,price:b.price})),C.push("/checkout?mode=buy-now")}catch(a){console.error(a),l.default.error("Failed to proceed")}};return(0,b.jsxs)("div",{className:"border border-gray-200 rounded-md bg-white",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 items-start lg:items-center justify-between gap-4 p-4 bg-define-brown text-white text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-white",children:"Order Placed"}),(0,b.jsx)("p",{className:"font-medium",children:new Date(c.createdAt).toDateString()})]}),(0,b.jsxs)("div",{className:"text-right lg:text-left",children:[(0,b.jsx)("p",{className:"text-white",children:"Total Amount"}),(0,b.jsxs)("p",{className:"font-medium",children:[(0,b.jsx)(f.FaRupeeSign,{className:"inline"}),c.orderValue.toFixed(0)]})]}),(0,b.jsxs)("div",{className:"",children:[(0,b.jsx)("p",{className:"text-white",children:"Ship To"}),(0,b.jsx)("p",{className:"font-medium",children:a?.name||""})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsxs)("p",{className:"text-white",children:["Order ID: ",(0,b.jsx)("span",{className:"font-medium",children:c.orderId})]}),(0,b.jsxs)("div",{className:"mt-1 space-x-2",children:[(0,b.jsx)(e.default,{href:"#",className:"text-white hover:text-define-red hover:underline",children:"View Order Details"}),(0,b.jsx)("span",{children:"|"}),"Processing"===c.status&&(0,b.jsx)("button",{type:"button",className:"text-white hover:text-define-red hover:underline",onClick:()=>{B({isOpen:!0,orderId:c._id,orderNumber:c.orderId,reason:"",isLoading:!1})},children:"Cancel Order"})]})]})]}),(0,b.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 p-4 border-t border-gray-200",children:[(0,b.jsxs)("div",{className:"md:w-[70%] w-full flex flex-col gap-3",children:[(0,b.jsx)("div",{className:" flex flex-col gap-1",children:(g=(a=>{switch(a.status){case"Processing":return{text:"Payment received. Your order is being prepared.",color:"text-orange-600"};case"Confirmed":case"Shipped":return{text:a.shipping?.expectedDeliveryDate?`Expected delivery by ${a.shipping.expectedDeliveryDate}`:"Expected delivery date will be updated soon",color:"text-blue-600"};case"Delivered":return{text:a.shipping?.expectedDeliveryDate?`Delivered on ${a.shipping.expectedDeliveryDate}`:"Delivered successfully",color:"text-define-brown"};case"Cancelled":return{text:"This order has been cancelled",color:"text-red-600"};default:return{text:"Order status updated",color:"text-gray-500"}}})(c),(0,b.jsx)("p",{className:"text-base  mt-2 font-semibold text-gray-500",children:g.text}))}),(0,b.jsxs)("div",{className:"flex flex-col lg:flex-row items-center justify-center gap-4 w-full ",children:[(0,b.jsx)("div",{className:"md:flex items-center justify-center border border-gray-200 rounded-md w-full md:w-fit  ",children:c.product?.coverImage?.url?(0,b.jsx)("div",{className:"  md:size-40 relative h-72 w-full",children:(0,b.jsx)(d.default,{src:c.product.coverImage.url,alt:c.product?.name||"",fill:!0,className:"object-cover w-full h-full rounded-md  "})}):(0,b.jsx)("div",{className:" size-40 bg-gray-100 text-gray-300 text-center rounded-md flex justify-center items-center",children:"Image Unavailable"})}),(0,b.jsxs)("div",{className:" w-full",children:[(0,b.jsx)(e.default,{href:`/product/${c.product?.slug}`,className:"font-medium text-gray-800 max-w-md",children:c.product?.name||"Product Unabailable"}),(0,b.jsxs)("div",{className:"flex gap-1 text-sm text-gray-600 mt-1 flex-wrap",children:[(0,b.jsx)("p",{children:c.address?.area}),", ",(0,b.jsx)("p",{children:c.address?.city}),",",(0,b.jsx)("p",{children:c.address?.state}),",",(0,b.jsxs)("p",{children:["Pin: ",c.address?.pin]})]}),(0,b.jsxs)("div",{className:" flex flex-wrap gap-2",children:[F(c)&&(0,b.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:F(c)}),(0,b.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["| Qty:"," ",(0,b.jsx)("span",{className:"font-medium",children:c.quantity})]})]}),(0,b.jsxs)("div",{className:"flex md:flex-row flex-col gap-3  mt-4 w-full",children:[h?(0,b.jsx)("button",{onClick:()=>j(c.product,i),disabled:0===i,className:`lg:px-6 lg:py-4 p-3 text-sm  lg:text-sm bg-define-brown text-white rounded hover:bg-define-red w-full md:w-fit text-center ${0===i?"bg-gray-300 text-gray-500 cursor-not-allowed opacity-60":"bg-define-brown hover:bg-define-red text-white"}`,children:"Buy Again"}):(0,b.jsx)("button",{disabled:!0,className:"lg:px-6 lg:py-4 p-3 text-sm lg:text-sm bg-gray-200 text-gray-500 rounded w-full md:w-fit cursor-not-allowed",title:"Product no longer available",children:"Buy Again"}),h?(0,b.jsx)(e.default,{href:`/product/${c.product.slug}`,className:"lg:px-6 lg:py-4 p-3 text-sm lg:text-sm bg-yellow-400 rounded hover:bg-yellow-500 w-full md:w-fit text-center",children:"View Your Item"}):(0,b.jsx)("button",{disabled:!0,className:"lg:px-6 lg:py-4 p-3 text-sm lg:text-xs bg-gray-200 text-gray-500 rounded w-full md:w-fit cursor-not-allowed",title:"Product no longer available",children:"Product Unavailable"})]})]})]})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-3 md:gap-2 w-full md:w-56",children:[(0,b.jsx)("button",{className:`w-full md:px-4 md:py-2 p-3 text-sm bg-define-brown text-white rounded hover:bg-define-red capitalize ${n[c.status]}`,children:c.status}),(0,b.jsx)("button",{onClick:()=>{z(c),x(!0)},className:"w-full md:px-4 md:py-2 p-3 text-sm bg-define-brown text-white rounded hover:bg-define-red",children:"Track Your Order"}),(0,b.jsx)("button",{className:"w-full md:px-4 md:py-2 p-3 text-sm bg-define-brown text-white rounded hover:bg-define-red",children:"View Return / Replacement"}),"Delivered"===c.status&&(0,b.jsx)(e.default,{href:`/review?product=${c.product?.slug}`,children:(0,b.jsx)("button",{className:"w-full px-4 py-2 text-sm bg-define-brown text-white rounded hover:bg-define-red",children:"Write a Review"})})]})]},c.product?._id||"")]},c.orderId)}),s>1&&(0,b.jsxs)("div",{className:"flex items-center justify-center gap-2 mt-8 pb-4",children:[(0,b.jsx)("button",{onClick:()=>r(a=>Math.max(1,a-1)),disabled:1===q,className:"p-2 border rounded-md hover:bg-gray-50 disabled:opacity-30 disabled:cursor-not-allowed transition-colors",children:(0,b.jsx)(m.BiChevronLeft,{size:18})}),(0,b.jsx)("div",{className:"flex items-center gap-1",children:(()=>{let a=[];if(s<=5)for(let b=1;b<=s;b++)a.push(b);else q<=3?a.push(1,2,3,4,"...",s):q>=s-2?a.push(1,"...",s-3,s-2,s-1,s):a.push(1,"...",q-1,q,q+1,"...",s);return a})().map((a,c)=>(0,b.jsx)("button",{disabled:"..."===a,onClick:()=>"number"==typeof a&&r(a),className:`
                  min-w-9 h-9 px-3 rounded-md text-sm font-medium transition-all
                  ${a===q?"bg-define-brown text-white shadow-md":"..."===a?"text-gray-400 cursor-default":"bg-white border border-gray-200 text-gray-700 hover:bg-green-50 hover:text-define-red hover:border-green-200"}
                `,children:a},c))}),(0,b.jsx)("button",{onClick:()=>r(a=>Math.min(s,a+1)),disabled:q===s,className:"p-2 border rounded-md hover:bg-gray-50 disabled:opacity-30 disabled:cursor-not-allowed transition-colors",children:(0,b.jsx)(m.BiChevronRight,{size:18})})]}),(0,b.jsx)(h,{open:w,order:y,onClose:()=>{x(!1),z(null)}})]}):(0,b.jsx)("div",{className:"bg-white p-8 rounded-lg text-center text-gray-500 shadow-sm w-full",children:"You have no orders yet"})}a.s(["STATUS_COLORS",0,n,"default",()=>o],57374)}];

//# sourceMappingURL=src_components_account_Orders_tsx_b7fc159f._.js.map